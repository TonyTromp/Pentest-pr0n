NOTES FROM: SANS500

Microsoft OS Version
* Purpose: Determine Windows Version, service pack and install date
* Identify OS Version
```
SOFTWARE\Microsoft\Windows NT\CurrentVersion
```

Identify Current ControlSet
```
SYSTEM\Select
SYSTEM\Select\Current
```

ComputerName
```
SYSTEM\CurrentControlSet\Control\ComputerName\ComputerName
```

Time Zone Information
```
SYSTEM\CurrentControlSet\Control\TimeZoneInformation
```

NTFS Last Access Time On/Off
```
SYSTEM\CurrentControlSet\Control\FileSytem
```

Network Interfaces
* List network Interfaces
* Can determine wether machine has static IP address or configured by DHCP
* Obtain Interface GUID
```
SYSTEM\CurrentControlSet\Services\Tcpip\Parameters\Interfaces
```

Historical Networks - Network List Keys
* Identify networks that the computer has been connected to
* First and last time a connection ha been made
* Networks could be Wired or Wireless
* Identify SSID
* Identifiy Gateway MAC Address
```
SOFTWARE\Microsoft\Windows NT\CurrentVersion\NetworkList\Signatures\Unmanaged
SOFTWARE\Microsoft\Windows NT\CurrentVersion\NetworkList\Signatures\Managed
SOFTWARE\Microsoft\Windows NT\CurrentVersion\NetworkList\Nla\Cache
```

Network Profiles Key - First and Last Time Connected
* Identify Type of Network that the computer was connected to
* Identify wireless SSID (to be mapped on Wiggle)
* Time is recorded in UTC
```
SOFTWARE\Microsoft\WZCSVC\Parameters\Interfaces\{GUID} (XP)
SOFTWARE\Microsoft\Windows NT\CurrentVersion\NetworkList\Profiles (Win7-10)
```
Values
- 0x47 = Wireless
- 0x06 = Wired
- 0x17 = Broadband (3g)

Shares and Offline Caching
* List the Open network Shares on the local system
* List flags and configuration settings
```
SYSTEM\CurrentControlSet\Services\lanmanserver\Shares\
```


System Boot Autostart Programs
```
* NTUSER.DAT\Software\Microsoft\Windows\CurrentVersion\Run
* NTUSER.DAT\Software\Microsoft\Windows\CurrentVersion\RunOnce
* Software\Microsoft\Windows\CurrentVersion\Run
* Software\Microsoft\Windows\CurrentVersion\RunOnce
* Software\Microsoft\Windows\CurrentVersion\policies\Explorer\Run
* (SERVICES) SYSTEM\CurrentControlSet\Services
** If Start value is set to 0x02 then service will start at boot
```

Shutdown Information
```
SYSTEM\CurrentControlSet\Control\Windows
SYSTEM\CurrentControlSet\Control\Watchdog\Display (shutdown count)
```

Manually Typed Paths in Explorer (cache)
* Forensics or
* Manipilate to let user execute data
```
NTUSER.DAT\Software\Microsoft\Windows\CurrentVersion\Explorer\TypedPaths
```

Recent Docs in Explorer
* Forensics or
* Manipilate to let user execute data
```
NTUSER.DAT\Software\Microsoft\Windows\CurrentVersion\Explorer\RecentDocs
```

Recent Docs in Microsoft Office
* Adds a lot of meta information which can determine exactly what the user did and when
```
NTUSER.DAT\Software\Microsoft\Office\VERSION\User MRU\LiveID_####\File MRU

NTUSER.DAT\Software\Microsoft\Office\16.0\Powerpoint\User MRU\LiveID_####\File MRU
NTUSER.DAT\Software\Microsoft\Office\14.0\Excel\User MRU\File MRU
NTUSER.DAT\Software\Microsoft\Office\14.0\Word\User MRU\File MRU
```

RunMRU (Windows+R)
* Order of commands beeing Executed
* Commands XP/Vista/Win7 commands are Typed in the Run box
```
NTUSER.DAT\Software\Microsoft\Windows\CurrentVersion\Explorer\RunMRU
```

ROT13 encoded Programs run by User Interactions
* 1024 Processes ever run
* Last Run Time
* Run Count
```
NTUSER.DAT\Software\Microsoft\Windows\CurrentVersion\Explorer\UserAssist\{GUID}\Count
```
NOTE: UserAssist has multiple GUID entries. Each entry symbolizes a Type of file beeing executed.
{BFFXXXX} means executables. 
Data relies under Count are best viewed using a better RegistryViewer such as: RegistryExplorer (which also decodes some values).

AMCache What is Run when its run
* First Time of Execution
* amcacheparser.py
* sha-1 of file
```
* XP: SYSTEM\CurrentControlSet\Control\SessionManager\AppCompatibility\AppCompatCache
* Server 2003-2016 / Win7-10: SYSTEM\CurrentControlSet\Control\SessionManager\AppCompatCache\AppCompatCache
```

amcacheparser -f E:\[root]\Windows\AppCompat\Programs\Amcache.hve --csv <FOLDER>

PowerForensics
```
Import-Module PowerForensics
Get-ForensicAmcache -HivePath E:\Windows\AppCompat\Programs\Amcache.hve
```

